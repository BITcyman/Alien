# Target

项目重构计划

## 物理内存管理

- [X] 实现伙伴系统管理物理页
- [X] 规范位图分配器的实现和接口
- [ ] 调整slab系统的分配大小，允许调整上限值
- [ ] 设计实现类似`vmalloc`的内核内存分配接口，2MB-4MB大小由伙伴系统直接分配，4MB大小大小以上的从虚拟地址空间分配

## 虚拟内存管理

- [x] 重构 `page-table` 的实现，规范接口
  - [x] 使用来自`Arceos`的实现，添加了额外的函数可以更灵活管理页表

- [x] 添加内核缺页异常处理
- [x] Copy on Write | Lazy allocation
  - [x] fork - -> Cow
  - [x] mmap/sbrk --> Lazy


## Device

- [ ] Cache layer

## 锁

- [x] 规范互斥锁和睡眠锁的实现
  - [x] 自旋锁
  - [x] 睡眠锁

- [x] 考虑是否需要关中断
- [x] 考虑多核上的锁与单核的差异

## 中断处理

- [x] 多核启动
- [x] 处理多核上的外部中断事件，比如串口
  - [x] 只在启动核设置外部中断


## 进程/线程管理

- [ ] 
  添加合适的数据结构并修改相关方法，在进程已有的抽象上添加线程抽象，需要保证两者使用同一个数据结构，参考linux系统与另一个同学实现的`Maturin`
- [ ] 添加多核调度的支持
- [ ] 内核线程支持



## 同步

- [ ] 信号量

## 文件系统

- [x] 修复已知错误
    - [x] `readdir`函数
    - [x] `mount`
- [x] 实现`devfs`
- [ ] 规范内核的设备文件系统实现，将探测得到的设备或者其他可抽象的数据结构创建为设备文件

## Special

- [ ] GUI
    - [ ] `embedded-graphics `较为底层，需要在此基础上构建
    - [ ] `slint` 较为成熟，并且可以在裸机器上运行，可以配合`embedded-graphics`使用
        - [x] 简易显示程序
        - [x] 键盘、鼠标事件(需要更好的支持)
        - [ ] shell
- [ ] Network
    - [ ] smoltcp
    - [ ] From scratch
- [ ] Board
    - [ ] VisionFive2
    - [ ] 华山派
- [ ] Arch
    - [x] riscv
    - [ ] loonarch64